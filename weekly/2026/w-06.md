# Weekly Log 06: Resolving at the Source

> 05 Feb 2026 – 07 Feb 2026

## Overview

This week centered on a key architectural shift in how **currency-denominated
Offers** are handled within Bolt12 flows. After stepping back and re-evaluating
earlier design assumptions, I arrived at a cleaner and more localized approach
to currency conversion — one that simplifies the system while preserving
flexibility. The rest of the week was spent validating that direction through
implementation, API design, and documentation.

## Highlights

### Currency Conversion: A Simpler Shape

- Reached a decisive architectural insight: across all stages of Bolt12
  communication, the system only needs the **resolved Offer amount**, not
  currency-aware logic threaded throughout.
- Reframed the design to **resolve currency conversion at the source**, store
  the resolved value, and allow the rest of the codebase to operate purely in
  millisatoshis.
- This shift significantly reduces trait plumbing, keeps currency handling
  localized, and avoids spreading conversion complexity across unrelated
  layers.  
  ([Implementation work][CurrencyCommits39])

### Carrying the Design Forward

- Extended `Invoice` and `InvoiceRequest` to consume the resolved Offer amount
  cleanly, without reintroducing downstream conversion awareness.
- Thought carefully about API boundaries: whether amount interpretation should
  happen automatically within public APIs or remain an explicit user action.
- Began experimenting with allowing LDK to **create Offers denominated in
  currency**, using this as a stress test for the overall model.

### Refinement and Documentation

- Cleaned up the implementation to ensure the currency approach feels deliberate
  rather than additive.
- Added documentation and guidance to clearly explain how users can interpret
  amounts and integrate currency conversion correctly.
- Extended currency support into internal code paths to ensure the design holds
  consistently beyond surface-level APIs.  
  ([Implementation work][CurrencyCommits40])

## Reflections

This was a week of architectural alignment more than raw throughput. The most
important progress came from letting go of a design that technically worked but
felt heavy, and replacing it with one that feels lighter, clearer, and more
contained.

Once the core insight landed, the rest of the work became about proving it —
through implementation, API decisions, and documentation. By the end of the
week, the shape of the solution felt stable, and the remaining work clearly
bounded.

A quiet but meaningful step forward.

[CurrencyCommits39]:
  https://github.com/shaavan/rust-lightning/commits/currency-39
[CurrencyCommits40]:
  https://github.com/shaavan/rust-lightning/commits/currency-40
