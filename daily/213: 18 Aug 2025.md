# Log 213: An Ingenious Solution

> 18 August 2025

## What I Worked On

- [Solved][commit] the paying-offer flow problem with Currency.

[commit]: https://github.com/shaavan/rust-lightning/commits/currency-29

## Reflections

On the last workday, I wrestled with a tricky problem: how to verify that a
received invoice amount is sufficient when the invoice request amount is
_absent_ and the offer amount is specified in currency.

Initially, the path seemed heavy—passing the currency conversion trait upstream
would have meant introducing boilerplate and unnecessary complexity into invoice
parsing. It felt clunky, fragile, and inelegant.

After a restful mid-week break, I approached it with fresh eyes. Instead of
fighting the problem head-on, I asked: _what if the problem never needed to
exist in the first place?_

The insight was simple: since we control invoice request creation—and we only
ever receive invoices that correspond to our own requests—why not ensure that we
never create an invoice request without an amount when the offer is in currency?
With that one constraint, the issue evaporated. No messy parsing. Just a clear
10-line safeguard.

It was deeply satisfying—one of those moments where the best solution isn’t
about cleverness, but about stepping aside and letting the problem dissolve.

Onto the next.
