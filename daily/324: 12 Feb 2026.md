# Log 324: Choosing the Better Path

> 12 Feb 2026

## What I Worked On

- [Progressed] on the currency support PR

## Reflections

After a detailed discussion with my mentor on the currency PR, I revisited the
“interpreted amount at the source” approach.

While it significantly reduced plumbing across the codebase, it introduced a
more serious concern: mutating data structures after they have already been
parsed. In protocol-level code, that pattern carries real security implications.
Parsed structures should remain stable and immutable once validated.

With that in mind, I returned to the downstream trait-parameterization approach.
It requires more plumbing, but it preserves structural integrity and keeps the
conversion logic explicit.

After cleaning and adapting it to the latest changes, I extended the design by
introducing the `CurrencyConversion` trait into `ChannelManager` and
`OffersMessageFlow` parameterization.

With the architectural direction now settled, the final step is adding
comprehensive tests for currency conversion support.

Tomorrow is about validating the model.

[Progressed]: https://github.com/shaavan/rust-lightning/commits/currency-43
