# Log 300: One Test to Go

> 03 Jan 2025

## What I Worked On

- [Progressed] on implementing recurrence expiry logic

## Reflections

Today I returned to one of my favorite projects — the recurrence PoC — with the
goal of implementing **recurrence expiry logic**.

There are multiple reasons an inbound or outbound recurrence session can expire.
The two primary ones are:

- reaching the configured recurrence count limit, and
- exceeding the time window for payment in the current recurrence period.

I was able to implement a clean and coherent mechanism that handles both cases.

There is, however, one catch.

Somehow, this change violates the lock order in _exactly one test_. Not dozens.
Not hundreds. Just one. Every other test passes, which makes this both
reassuring and deeply annoying.

That’s the challenge I’ll pick up the next time I open the recurrence book.

Also, this is my 300th log. Let's go!

[Progressed]: https://github.com/shaavan/rust-lightning/commits/recurrence-30
