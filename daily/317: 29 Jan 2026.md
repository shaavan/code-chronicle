# Log 317: Voilà!

> 29 Jan 2026

## What I Worked On

- [Progressed] on the dummy hops follow-up

## Reflections

Today I made solid progress on solving the slightly-off **dummy hops fee
calculation** issue.

While struggling to pin down the discrepancy, a moment of intuition hit: _what
values do the tests use for payment relay and constraints on real forward hops?_
Following that thread and doing some targeted debugging led me to an important
discovery.

The test setup uses **finite base fees**, but **zero proportional fees**.

That was the missing piece.

Fees for a blinded path are calculated on an **aggregated basis** — we only
expose the total cost of using the entire blinded path to preserve privacy,
rather than revealing per-hop breakdowns. However, during actual payment
transmission, fees are deducted **per hop**.

The test checks that:

> aggregated fees == sum of individual hop fees

This equality only holds when no fee component depends on the payment amount —
i.e., when the **proportional fee is zero**.

And voilà, everything clicked!

With the puzzle solved, tomorrow is all about cleanup and finishing up the
follow-up work.

A good day.

[Progressed]: https://github.com/shaavan/rust-lightning/commits/dummy-follow
